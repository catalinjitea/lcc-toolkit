{% extends "index.html" %}

{% load static %}

{% block extra-scripts %}
  <script src="{% static "js/legislation_filter.js" %}"> </script>
  <script src="{% static "js/sidebar.js" %}"> </script>
{% endblock %}

{% block content-wrapper-class %}leg-viz with-sidebar{% endblock %}

{% block page-title %}Legislation Explorer{% endblock %}

{% block page-menu %}
<ul>
    <li><a href="{% url 'lcc:legislation:add' %}" class="btn btn-primary">Add legislation</a></li>
</ul>
{% endblock %}


{% block breadcrumbs %}{% endblock %}

{% block content %}
  <div class="search">
    <div class="row">
      <div class="input-group searchInputGroup">
        <div class="input-group searchInputWrapper">
          <input id="textSearchInput" type="text" name="q" placeholder="Search legislation database">
        </div>
        <div class="input-group-btn searchBtnWrapper">
          <button class="btn btn-primary submitBtn" type="button"><i class="fa fa-search" aria-hidden="true"></i> Search</button>
        </div><!-- /btn-group -->
      </div><!-- /input-group -->
    </div><!-- /row -->
  </div><!-- /search -->
<div id="laws" class="page-container half viz-container">
  {# TODO: add counter! #}
  {% include "./_laws.html" %}
</div>
<div class="page-container half viz-container right">
  <h4>Filter legislation</h4>

    <div class="filter-item list-container" id="classificationsDropDownWrapper">
     <label><b>Select Legal Area</b></label>
      <ul class="round" name="classifications" id="classificationsDropDown" multiple="multiple">
        {% for top_class in top_classifications %}
          <li class="first-level level">
            {% with top_class.get_children as second_classifications %}
              <span class="list-header">
                <input name='{{ top_class.pk }}' value='{{ top_class.pk }}' id='{{ top_class.pk }}' type='checkbox'/>
                <label for='{{ top_class.pk }}' name='{{ top_class.pk }}'>{{ top_class.name }}</label>
                {% if second_classifications %}
                  <i class="fa fa-caret-down" aria-hidden="true"></i>
                {% endif %}
              </span>
              <ul class="second-level level">
                {% for second_class in second_classifications %}
                  {% with second_class.get_children as third_classifications %}
                    <li>
                      <span class="list-header">
                        <label for="classification_{{ second_class.pk }}">{{ second_class.name }}</label>
                        {% if third_classifications %}
                          <i class="fa fa-caret-down" aria-hidden="true"></i>
                        {% endif %}
                      </span>
                      <ul class="third-level level">
                        {% for third_class in third_classifications %}
                          <li>
                            <label for="classification_{{ third_class.pk }}">{{ third_class.name }}</label>
                          </li>
                        {% endfor %}
                      </ul>
                    </li>
                  {% endwith %}
                {% endfor %}
              </ul>
            {% endwith %}
          </li>
        {% endfor %}
      </ul>
    </div>

    <div class="filter-item filter-countries">
    <label for="countryDropDown"><b>Country</b></label>
      <select class="round" name="country" id="countryDropDown">
        <option value="" selected>Select Country</option>
        {% for country in countries %}
          <option value="{{country.iso}}">{{ country.name }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="filter-item list-container filter-type">
    <label for="typeDropDown"><b>Select type</b></label>
      <ul class="round" name="type" id="typeDropDown">
        {% for key, value in legislation_type %}
          <li class="first-level level">
            <input type="checkbox" name="{{key}}" id="{{key}}" value="{{key}}"></input>
            <label for="{{key}}">{{ value }}</label>
          </li>
        {% endfor %}
      </ul>
    </div>

    <div class="filter-item filterTags">
    <label for="TagDropDown"><b>Cross cutting categories</b></label>
      <select class="round" name="tags" id="TagDropDown" multiple="multiple">
        {% for group_tag in group_tags %}
          <optgroup label="{{group_tag.name}}">
            {% for tag in group_tag.tags.all %}
              <option value="{{tag.pk}}" class="option-child-1">{{ tag.name }}</option>
            {% endfor %}
          </optgroup>
        {% endfor %}
      </select>
    </div>

    <button type="button" class="btn btn-primary submitBtn">Apply filters</button>

  </div>

{% endblock %}
