{% extends "legislation/explorer.html" %}

{% load static %}

{% block page-title %}{{ law.title }}{% endblock %}

{% block page-menu %} 
  <!-- {% include 'legislation/navigation.html' %} -->
  <ul>
    <li class="wide"><a href="{% url 'lcc:legislation:details' legislation_pk=law.pk %}" class="btn btn-link active">Overview</a></li>
    {% with law.articles.all as articles %}
    <li class="wide"><a href="{% url 'lcc:legislation:articles:view' legislation_pk=law.pk %}" class="btn btn-link {% if not articles %}disabled{% endif %}" title="{% if not articles %}This legislation does not have any articles defined.{% endif %}">Articles</a></li>
    {% endwith %}
    {% if request.user.is_authenticated %}
      <span class="separator"></span>
      {% if law.articles.all %}
      {% endif %}
      <li class="wide">
        <a class="btn btn-link"
           href="{% url 'lcc:legislation:edit' legislation_pk=law.pk %}">
          Edit legislation
        </a>
      </li>
      <li class="wide">
      <!-- ADD FUNCTIONALITY HERE -->
        <a class="btn btn-link">
          Delete legislation
        </a>
      </li>
      <li class="wide">
        <a class="btn btn-link"
           href="{% url 'lcc:legislation:articles:add' legislation_pk=law.pk %}">
          Add articles
        </a>
      </li>
  {% endif %}
</ul>
{% endblock %}

{% block body-layout-type %}extended{% endblock %}


{% block breadcrumbs %}
  {{ block.super }} 
  <span> <i class="icon-right-open-mini"></i><a href="{% url 'lcc:legislation:details' legislation_pk=law.pk %}">{{ law.title }}</a></span>
  <span> <i class="icon-right-open-mini"></i>Articles</span>
{% endblock %}

{% block content %}
<!-- <h3>
  {% static "" as baseUrl %}
  <img style="margin-right: .5rem;
    margin-top: -.5rem;
    width: 31px;" 
    class="flag" src="{{ baseUrl }}img/flags/{{ law.country.iso |lower }}.svg" >{{ law.title }}
</h3> -->
<div class="articles-container">
{% if articles %}
  {% for articlce in articles %}
    <div class="viz-container multiple">
      {% if request.user.is_authenticated %}
      <a class="btn btn-link pull-right" href="{% url 'lcc:legislation:articles:delete' legislation_pk=law.pk article_pk=article.pk %}" onclick="return confirm('Are you sure you want to delete this?')">Delete</a>
      <a class="btn btn-link pull-right" href="{% url 'lcc:legislation:articles:edit' legislation_pk=law.pk article_pk=article.pk %}">Edit article</a>
      {% endif %}

      {% if article.code %}
      <a class="article-title" href="#{{article.code}}">
        <h4 id="{{article.code}}">Article {{ article.code }}</h4>
      </a>
      {% endif %}

      {% if article.text %}
        <p><pre>{{ article.text }}</pre></p>
      {% endif %}

      <div class="dl">
          <div class="dd"><span>Classification</span></div>
          <div class="dt">
          {% if article.all_classifications %}
            {% for classification in article.classifications.all %}
             <span class="classification">{{ classification.name }}</span>
            {% endfor %}
          {% else %} - {% endif %}</div>
        </div>

        <div class="dl">
          <div class="dd"><span>Tags</span></div>
          <div class="dt">
          {% if article.all_tags %}
            {% for tag in article.tags.all%}
             <span class="tag">{{ tag.name }}</span>
            {% endfor %}
          {% else %} - {% endif %}</div>
        </div>

    </div>
  {% endfor %}
{% else %}
  <p>This law does not have articles.</p>
{% endif %}
</div>
{% endblock %}
